{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\zmka2\\\\Python\\\\react-fail\\\\shinshu-fesnav\\\\ykoyama\\\\nagano-festival-app\\\\src\\\\FestivalPage.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function FestivalPage() {\n  _s();\n  const [festivals, setFestivals] = useState([{\n    id: 1,\n    name: \"花火大会\",\n    rating: 0\n  }, {\n    id: 2,\n    name: \"夏祭り\",\n    rating: 0\n  }, {\n    id: 3,\n    name: \"雪まつり\",\n    rating: 0\n  }]);\n  const [favorites, setFavorites] = useState([]);\n  const [user, setUser] = useState(null);\n  const navigate = useNavigate();\n\n  // ✅ ログイン状態の確認\n  useEffect(() => {\n    const storedUser = JSON.parse(localStorage.getItem(\"currentUser\"));\n    if (!storedUser) {\n      alert(\"ログインしてください\");\n      navigate(\"/\");\n    } else {\n      setUser(storedUser);\n\n      // ユーザーごとのデータ読み込み\n      const storedFavorites = JSON.parse(localStorage.getItem(`favorites_${storedUser.username}`)) || [];\n      const storedRatings = JSON.parse(localStorage.getItem(`ratings_${storedUser.username}`)) || {};\n      setFavorites(storedFavorites);\n\n      // 評価を適用\n      setFestivals(prev => prev.map(f => ({\n        ...f,\n        rating: storedRatings[f.id] || 0\n      })));\n    }\n  }, [navigate]);\n\n  // ✅ お気に入り登録/解除\n  const toggleFavorite = festivalId => {\n    if (!user) return;\n    const updatedFavorites = favorites.includes(festivalId) ? favorites.filter(id => id !== festivalId) : [...favorites, festivalId];\n    setFavorites(updatedFavorites);\n    localStorage.setItem(`favorites_${user.username}`, JSON.stringify(updatedFavorites));\n  };\n\n  // ✅ 評価変更\n  const handleRating = (festivalId, rating) => {\n    if (!user) return;\n    const updatedFestivals = festivals.map(f => f.id === festivalId ? {\n      ...f,\n      rating\n    } : f);\n    setFestivals(updatedFestivals);\n\n    // ユーザーごとに保存\n    const ratings = JSON.parse(localStorage.getItem(`ratings_${user.username}`)) || {};\n    ratings[festivalId] = rating;\n    localStorage.setItem(`ratings_${user.username}`, JSON.stringify(ratings));\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"festival-page\",\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"\\u304A\\u796D\\u308A\\u4E00\\u89A7\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 7\n    }, this), festivals.map(festival => /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"festival-item\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: festival.name\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [1, 2, 3, 4, 5].map(star => /*#__PURE__*/_jsxDEV(\"span\", {\n          style: {\n            cursor: \"pointer\",\n            color: star <= festival.rating ? \"gold\" : \"gray\",\n            fontSize: \"1.5em\"\n          },\n          onClick: () => handleRating(festival.id, star),\n          children: \"\\u2605\"\n        }, star, false, {\n          fileName: _jsxFileName,\n          lineNumber: 78,\n          columnNumber: 15\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => toggleFavorite(festival.id),\n        children: favorites.includes(festival.id) ? \"お気に入り解除\" : \"お気に入り登録\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 11\n      }, this)]\n    }, festival.id, true, {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 9\n    }, this))]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 68,\n    columnNumber: 5\n  }, this);\n}\n_s(FestivalPage, \"2dNupkKxMFJlV8WSS2G7tnMP4Zs=\", false, function () {\n  return [useNavigate];\n});\n_c = FestivalPage;\nvar _c;\n$RefreshReg$(_c, \"FestivalPage\");","map":{"version":3,"names":["React","useState","useEffect","useNavigate","jsxDEV","_jsxDEV","FestivalPage","_s","festivals","setFestivals","id","name","rating","favorites","setFavorites","user","setUser","navigate","storedUser","JSON","parse","localStorage","getItem","alert","storedFavorites","username","storedRatings","prev","map","f","toggleFavorite","festivalId","updatedFavorites","includes","filter","setItem","stringify","handleRating","updatedFestivals","ratings","className","children","fileName","_jsxFileName","lineNumber","columnNumber","festival","star","style","cursor","color","fontSize","onClick","_c","$RefreshReg$"],"sources":["C:/Users/zmka2/Python/react-fail/shinshu-fesnav/ykoyama/nagano-festival-app/src/FestivalPage.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { useNavigate } from \"react-router-dom\";\r\n\r\nexport default function FestivalPage() {\r\n  const [festivals, setFestivals] = useState([\r\n    { id: 1, name: \"花火大会\", rating: 0 },\r\n    { id: 2, name: \"夏祭り\", rating: 0 },\r\n    { id: 3, name: \"雪まつり\", rating: 0 },\r\n  ]);\r\n\r\n  const [favorites, setFavorites] = useState([]);\r\n  const [user, setUser] = useState(null);\r\n  const navigate = useNavigate();\r\n\r\n  // ✅ ログイン状態の確認\r\n  useEffect(() => {\r\n    const storedUser = JSON.parse(localStorage.getItem(\"currentUser\"));\r\n    if (!storedUser) {\r\n      alert(\"ログインしてください\");\r\n      navigate(\"/\");\r\n    } else {\r\n      setUser(storedUser);\r\n\r\n      // ユーザーごとのデータ読み込み\r\n      const storedFavorites = JSON.parse(localStorage.getItem(`favorites_${storedUser.username}`)) || [];\r\n      const storedRatings = JSON.parse(localStorage.getItem(`ratings_${storedUser.username}`)) || {};\r\n\r\n      setFavorites(storedFavorites);\r\n\r\n      // 評価を適用\r\n      setFestivals((prev) =>\r\n        prev.map((f) => ({\r\n          ...f,\r\n          rating: storedRatings[f.id] || 0,\r\n        }))\r\n      );\r\n    }\r\n  }, [navigate]);\r\n\r\n  // ✅ お気に入り登録/解除\r\n  const toggleFavorite = (festivalId) => {\r\n    if (!user) return;\r\n\r\n    const updatedFavorites = favorites.includes(festivalId)\r\n      ? favorites.filter((id) => id !== festivalId)\r\n      : [...favorites, festivalId];\r\n\r\n    setFavorites(updatedFavorites);\r\n    localStorage.setItem(`favorites_${user.username}`, JSON.stringify(updatedFavorites));\r\n  };\r\n\r\n  // ✅ 評価変更\r\n  const handleRating = (festivalId, rating) => {\r\n    if (!user) return;\r\n\r\n    const updatedFestivals = festivals.map((f) =>\r\n      f.id === festivalId ? { ...f, rating } : f\r\n    );\r\n    setFestivals(updatedFestivals);\r\n\r\n    // ユーザーごとに保存\r\n    const ratings = JSON.parse(localStorage.getItem(`ratings_${user.username}`)) || {};\r\n    ratings[festivalId] = rating;\r\n    localStorage.setItem(`ratings_${user.username}`, JSON.stringify(ratings));\r\n  };\r\n\r\n  return (\r\n    <div className=\"festival-page\">\r\n      <h1>お祭り一覧</h1>\r\n\r\n      {festivals.map((festival) => (\r\n        <div key={festival.id} className=\"festival-item\">\r\n          <h3>{festival.name}</h3>\r\n\r\n          {/* ⭐ 評価 */}\r\n          <div>\r\n            {[1, 2, 3, 4, 5].map((star) => (\r\n              <span\r\n                key={star}\r\n                style={{\r\n                  cursor: \"pointer\",\r\n                  color: star <= festival.rating ? \"gold\" : \"gray\",\r\n                  fontSize: \"1.5em\",\r\n                }}\r\n                onClick={() => handleRating(festival.id, star)}\r\n              >\r\n                ★\r\n              </span>\r\n            ))}\r\n          </div>\r\n\r\n          {/* ❤️ お気に入り */}\r\n          <button onClick={() => toggleFavorite(festival.id)}>\r\n            {favorites.includes(festival.id) ? \"お気に入り解除\" : \"お気に入り登録\"}\r\n          </button>\r\n        </div>\r\n      ))}\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}